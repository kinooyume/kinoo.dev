---
/**
 * NavBar Component Documentation
 * Design System - Molecule
 */
---

<section id="navbar">
  <h2>NavBar</h2>
  <p class="atomic-label">Molecule</p>
  <p>Horizontal navigation bar with scroll-based active indicator and color-coded links for each section.</p>

  <div class="component-block">
    <h3>Interactive Demo</h3>
    <p class="note" style="margin-bottom: 16px;">Click or hover on links to see the indicator animation.</p>
    <div class="preview">
      <nav class="navbar-interactive" id="navbar-demo">
        <ul>
          <li><a href="#" data-color="#f68dab" class="nav active">Expériences</a></li>
          <li><a href="#" data-color="#66c384" class="nav">Réalisations</a></li>
          <li><a href="#" data-color="#9c85d3" class="nav">Formations</a></li>
        </ul>
        <div class="indicator"></div>
      </nav>
    </div>
  </div>

  <div class="component-block">
    <h3>Link Colors</h3>
    <div class="preview color-demo">
      <div class="color-link">
        <a href="#" class="nav-sample" style="--nav-color: #f68dab;">Expériences</a>
        <div class="color-indicator" style="background-color: #f68dab;"></div>
        <code>#f68dab</code>
      </div>
      <div class="color-link">
        <a href="#" class="nav-sample" style="--nav-color: #66c384;">Réalisations</a>
        <div class="color-indicator" style="background-color: #66c384;"></div>
        <code>#66c384</code>
      </div>
      <div class="color-link">
        <a href="#" class="nav-sample" style="--nav-color: #9c85d3;">Formations</a>
        <div class="color-indicator" style="background-color: #9c85d3;"></div>
        <code>#9c85d3</code>
      </div>
    </div>
  </div>

  <div class="component-block">
    <h3>Features</h3>
    <ul class="feature-list">
      <li>Animated indicator follows active/hovered link</li>
      <li>Indicator color matches section theme via <code>data-color</code></li>
      <li>Scroll-based detection updates active state</li>
      <li>Smooth 300ms transitions</li>
      <li>Hidden on mobile (&lt;980px)</li>
    </ul>
  </div>

  <div class="component-block">
    <h3>HTML Structure</h3>
    <div class="structure-diagram">
      <div class="structure-row">
        <code>nav.navbar</code>
        <span class="structure-desc">Container with relative positioning</span>
      </div>
      <div class="structure-row indent">
        <code>ul</code>
        <span class="structure-desc">Flex container for links</span>
      </div>
      <div class="structure-row indent-2">
        <code>li &gt; a.nav</code>
        <span class="structure-desc">Navigation links with data-color</span>
      </div>
      <div class="structure-row indent">
        <code>.indicator</code>
        <span class="structure-desc">Animated underline element</span>
      </div>
    </div>
  </div>

  <div class="component-block">
    <h3>Data Attributes</h3>
    <table class="props-table">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Element</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>data-color</code></td>
          <td>a.nav</td>
          <td>Hex color for indicator when active/hovered</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="component-block">
    <h3>CSS Classes</h3>
    <table class="props-table">
      <thead>
        <tr>
          <th>Class</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>.navbar</code></td>
          <td>Main container</td>
        </tr>
        <tr>
          <td><code>.nav</code></td>
          <td>Navigation link</td>
        </tr>
        <tr>
          <td><code>.active</code></td>
          <td>Current section (set by scroll detection)</td>
        </tr>
        <tr>
          <td><code>.enabled</code></td>
          <td>Added after hero animation completes</td>
        </tr>
        <tr>
          <td><code>.indicator</code></td>
          <td>Moving underline element</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="component-block">
    <h3>JavaScript Integration</h3>
    <p class="note">
      Uses <code>viewDetection</code> for scroll tracking. Waits for <code>onHeroAnimationComplete</code> before enabling interactions on pages with hero.
    </p>
  </div>
</section>

<script>
  // Interactive navbar demo
  const navbar = document.getElementById('navbar-demo');
  if (navbar) {
    const links = navbar.querySelectorAll('a');
    const indicator = navbar.querySelector('.indicator') as HTMLElement;
    let activeLink: Element | null = navbar.querySelector('a.active');

    function updateIndicator(link: Element) {
      const rect = link.getBoundingClientRect();
      const parentRect = navbar.getBoundingClientRect();
      indicator.style.left = `${rect.left - parentRect.left}px`;
      indicator.style.width = `${rect.width}px`;
      indicator.style.backgroundColor = (link as HTMLElement).dataset.color || 'var(--accent-color)';
    }

    // Initialize
    if (activeLink) {
      const link = activeLink;
      requestAnimationFrame(() => updateIndicator(link));
    }

    links.forEach(link => {
      link.addEventListener('mouseenter', () => updateIndicator(link));

      link.addEventListener('click', (e) => {
        e.preventDefault();
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        activeLink = link;
        updateIndicator(link);
      });
    });

    navbar.addEventListener('mouseleave', () => {
      if (activeLink) updateIndicator(activeLink);
    });
  }
</script>

<style>
  .navbar-interactive {
    position: relative;
    display: flex;
    align-items: center;
  }
  .navbar-interactive ul {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
    margin: 0;
  }
  .navbar-interactive li {
    list-style: none;
  }
  .navbar-interactive a {
    display: block;
    padding: 16px 16px;
    font-size: 18px;
    font-weight: 200;
    color: var(--color);
    text-decoration: none;
    opacity: 0.6;
    transition: opacity 0.2s ease;
  }
  .navbar-interactive a:hover,
  .navbar-interactive a.active {
    opacity: 1;
  }
  .navbar-interactive .indicator {
    position: absolute;
    bottom: 0;
    height: 2px;
    border-radius: 1px;
    transition: all 0.3s ease;
    background-color: var(--accent-color);
  }
  .color-demo {
    flex-direction: column;
    gap: 16px;
  }
  .color-link {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .nav-sample {
    font-size: 18px;
    font-weight: 200;
    color: var(--color);
    text-decoration: none;
    min-width: 120px;
  }
  .nav-sample:hover {
    color: var(--nav-color);
  }
  .color-indicator {
    width: 60px;
    height: 3px;
    border-radius: 2px;
  }
  .color-link code {
    font-size: 13px;
    color: var(--color);
    opacity: 0.6;
  }
  .feature-list {
    list-style: disc;
    padding-left: 24px;
    margin: 0;
  }
  .feature-list li {
    font-size: 15px;
    color: var(--light-color);
    margin-bottom: 8px;
  }
  .feature-list code {
    background-color: #1c2638;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 13px;
  }
  .structure-diagram {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 16px;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
  }
  .structure-row {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .structure-row code {
    background-color: #1c2638;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 13px;
    color: var(--accent-bright);
    min-width: 120px;
  }
  .structure-desc {
    font-size: 14px;
    color: var(--color);
    opacity: 0.7;
  }
  .indent { padding-left: 20px; }
  .indent-2 { padding-left: 40px; }
</style>
